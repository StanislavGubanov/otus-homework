
# Задание

## Сделать простейший RESTful CRUD по созданию, удалению, просмотру и обновлению пользователей.

Пример API - https://app.swaggerhub.com/apis/otus55/users/1.0.0 <br>
Добавить базу данных для приложения.<br>
Конфигурация приложения должна хранится в Configmaps.<br>
Доступы к БД должны храниться в Secrets.<br>
Первоначальные миграции должны быть оформлены в качестве Job-ы, если это требуется.<br>
Ingress-ы должны также вести на url arch.homework/ (как и в прошлом задании)<br>

# На выходе должны быть предоставлены

1. ссылка на директорию в github, где находится директория с манифестами кубернетеса
2. инструкция по запуску приложения.
* команда установки БД из helm, вместе с файлом values.yaml.
* команда применения первоначальных миграций
* команда kubectl apply -f, которая запускает в правильном порядке манифесты кубернетеса
3. Postman коллекция, в которой будут представлены примеры запросов к сервису на создание, получение, изменение и удаление пользователя. Важно: в postman коллекции использовать базовый url - arch.homework.
   Задание со звездочкой:
   +5 балла за шаблонизацию приложения в helm чартах

# Решение

```shell
kubectl create ns otus-dz-2 

# создаем секрет для подключения к бд
kubectl apply -f .\helm\charts\postgresql\password-secret.yaml

# добавляем репо bitnami
helm repo add bitnami https://charts.bitnami.com/bitnami

# ставим слоника в наш namespace

helm install -n otus-dz-2 my-release bitnami/postgresql --values=.\helm\charts\postgresql\values.yaml 

kubectl create -f .\configmap.yaml

kubectl apply -f .

# Запускаем тесты из `.\postman`
 
newman run ./postman/Otus.postman_collection.json

# вывод
#┌─────────────────────────┬──────────────────┬──────────────────┐
#│                         │         executed │           failed │
#├─────────────────────────┼──────────────────┼──────────────────┤
#│              iterations │                1 │                0 │
#├─────────────────────────┼──────────────────┼──────────────────┤
#│                requests │               13 │                0 │
#├─────────────────────────┼──────────────────┼──────────────────┤
#│            test-scripts │               25 │                0 │
#├─────────────────────────┼──────────────────┼──────────────────┤
#│      prerequest-scripts │               13 │                0 │
#├─────────────────────────┼──────────────────┼──────────────────┤
#│              assertions │               18 │                0 │
#├─────────────────────────┴──────────────────┴──────────────────┤
#│ total run duration: 792ms                                     │
#├───────────────────────────────────────────────────────────────┤
#│ total data received: 2.22kB (approx)                          │
#├───────────────────────────────────────────────────────────────┤
#│ average response time: 37ms [min: 5ms, max: 97ms, s.d.: 33ms] │
#└───────────────────────────────────────────────────────────────┘

kubectl delete ns otus-dz-2 

```

